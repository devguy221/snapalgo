"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Creates a pair of `setTimeout` and `clearTimeout` functions attenuated such
 * that:
 * - `setTimeout` throws if its "handler" parameter is not a function.
 * - `clearTimeout` only clears timeouts created by its sibling `setTimeout`,
 *   or else no-ops.
 *
 * @returns An object with the attenuated `setTimeout` and `clearTimeout`
 * functions.
 */
const createTimeout = () => {
    const registeredTimeouts = new Set();
    const _setTimeout = (handler, timeout) => {
        if (typeof handler !== 'function') {
            throw new Error(`The timeout handler must be a function. Received: ${typeof handler}`);
        }
        const handleWrapper = { handle: NaN };
        handleWrapper.handle = setTimeout(() => {
            registeredTimeouts.delete(handleWrapper.handle);
            handler();
        }, timeout);
        registeredTimeouts.add(handleWrapper.handle);
        return handleWrapper.handle;
    };
    const _clearTimeout = (handle) => {
        if (registeredTimeouts.has(handle)) {
            clearTimeout(handle);
            registeredTimeouts.delete(handle);
        }
    };
    return { setTimeout: _setTimeout, clearTimeout: _clearTimeout };
};
const endowmentModule = {
    names: ['setTimeout', 'clearTimeout'],
    factory: createTimeout,
};
exports.default = endowmentModule;
//# sourceMappingURL=timeout.js.map