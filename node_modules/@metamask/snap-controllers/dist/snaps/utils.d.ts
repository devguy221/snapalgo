import { Json } from '@metamask/utils';
import { NpmSnapPackageJson, SnapManifest } from './json-schemas';
export declare enum SnapIdPrefixes {
    npm = "npm:",
    local = "local:"
}
export declare enum NpmSnapFileNames {
    PackageJson = "package.json",
    Manifest = "snap.manifest.json"
}
export declare const LOCALHOST_HOSTNAMES: Set<string>;
export declare const DEFAULT_NPM_REGISTRY = "https://registry.npmjs.org";
export declare const DEFAULT_REQUESTED_SNAP_VERSION = "*";
export declare const PROPOSED_NAME_REGEX: RegExp;
/**
 * Calculates the Base64-econded SHA-256 digest of a Snap source code string.
 *
 * @param sourceCode - The UTF-8 string source code of a Snap.
 * @returns The Base64-encoded SHA-256 digest of the source code.
 */
export declare function getSnapSourceShasum(sourceCode: string): string;
export declare type ValidatedSnapId = `local:${string}` | `npm:${string}`;
/**
 * An object for storing parsed but unvalidated Snap file contents.
 */
export declare type UnvalidatedSnapFiles = {
    manifest?: Json;
    packageJson?: Json;
    sourceCode?: string;
    svgIcon?: string;
};
/**
 * An object for storing the contents of Snap files that have passed JSON
 * Schema validation, or are non-empty if they are strings.
 */
export declare type SnapFiles = {
    manifest: SnapManifest;
    packageJson: NpmSnapPackageJson;
    sourceCode: string;
    svgIcon?: string;
};
/**
 * Fetches a Snap from the public npm registry.
 *
 * @param packageName - The name of the package whose tarball to fetch.
 * @param versionRange - The SemVer range of the package to fetch, max satisfying will be fetched
 * @param fetchFunction - The fetch function to use. Defaults to the global
 * {@link fetch}. Useful for Node.js compatibility.
 * @returns A tuple of the Snap manifest object and the Snap source code.
 */
export declare function fetchNpmSnap(packageName: string, versionRange: string, registryUrl?: string, fetchFunction?: typeof fetch): Promise<SnapFiles>;
/**
 * Snap validation failure reason codes that are programmatically fixable
 * if validation occurs during development.
 */
export declare enum SnapValidationFailureReason {
    NameMismatch = "\"name\" field mismatch",
    VersionMismatch = "\"version\" field mismatch",
    RepositoryMismatch = "\"repository\" field mismatch",
    ShasumMismatch = "\"shasum\" field mismatch"
}
/**
 * An error indicating that a Snap validation failure is programmatically
 * fixable during development.
 */
export declare class ProgrammaticallyFixableSnapError extends Error {
    reason: SnapValidationFailureReason;
    constructor(message: string, reason: SnapValidationFailureReason);
}
/**
 * Validates the files extracted from an npm Snap package tarball by ensuring
 * that they're non-empty and that the Json files match their respective schemas
 * and the Snaps publishing specification.
 *
 * @param snapFiles - The object containing the expected Snap file contents,
 * if any.
 * @param packageName - The name of the package whose tarball to fetch.
 * @param version - The version of the package to fetch, or the string `latest`.
 * @param errorPrefix - The prefix of the error message.
 * @returns A tuple of the Snap manifest object and the Snap source code.
 */
export declare function validateNpmSnap(snapFiles: UnvalidatedSnapFiles, errorPrefix: `${string}: `): SnapFiles;
/**
 * Validates the fields of an npm Snap manifest that has already passed JSON
 * Schema validation.
 *
 * @param manifest - The npm Snap manifest to validate.
 * @param packageJson - The npm Snap's `package.json`.
 * @param sourceCode - The Snap's source code.
 * @param errorPrefix - The prefix for error messages.
 */
export declare function validateNpmSnapManifest({ manifest, packageJson, sourceCode }: SnapFiles, errorPrefix: `${string}: `): [SnapManifest, string, NpmSnapPackageJson];
/**
 * Checks whether the source.shasum property of the specified Snap manifest
 * matches the shasum of the specified snap source code string.
 *
 * @param manifest - The manifest whose shasum to validate.
 * @param sourceCode - The source code of the snap.
 */
export declare function validateSnapShasum(manifest: SnapManifest, sourceCode: string, errorMessage?: string): void;
/**
 * Parse a version received by some subject attempting to access a snap.
 * @param version - The received version value.
 * @returns `*` if the version is `undefined` or `latest", otherwise returns
 * the specified version.
 */
export declare function resolveVersion(version?: Json): Json;
/**
 * Checks whether a version range is valid.
 *
 * @param versionRange - A potential version range
 * @returns True if the version range is valid
 */
export declare function isValidSnapVersionRange(versionRange: unknown): versionRange is string;
/**
 * Gets the corresponding snap prefix from a snap id
 *
 * @param snapId - Snap id
 * @returns The snap prefix from a snap id, i.e: "npm:"
 */
export declare function getSnapPrefix(snapId: string): SnapIdPrefixes;
export declare const SNAP_PREFIX = "wallet_snap_";
/**
 * Gets permission name of a snap given its snap id
 *
 * @param snapId - Snap id
 * @returns The permission name
 */
export declare function getSnapPermissionName(snapId: string): string;
